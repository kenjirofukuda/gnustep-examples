Object subclass: #GdsCompatibility	instanceVariableNames: ''	classVariableNames: 'Checker CompatibilityClass DefaultCompatibility'	poolDictionaries: ''	category: 'GdsFeel-Model-Spec'!!GdsCompatibility commentStamp: 'kf 11/12/2008 12:03' prior: 0!A GdsCompatibility is controls GDS II simulation spec level  .Instance Variables!!GdsCompatibility methodsFor: 'convert' stamp: 'kf 10/23/2008 23:48'!checker	^self class checker.! !!GdsCompatibility methodsFor: 'convert' stamp: 'kf 10/26/2008 09:53'!coerceStructureName: aString	| partial |	partial := aString copyReplaceAll: ' ' with: '_' .	partial ifEmpty: [^'' copy].	^self checker checkName: partial fixErrors: true.! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 10/23/2008 10:15'!elementColorAllowed	^true! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 6/22/2009 15:11'!isValidLibraryName: aString 	(self isValidStorageName: aString)		ifFalse: [^false].	^aString matchesRegex: '[A-Z][A-Z0-9$_]+'.! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 6/12/2009 12:46'!isValidStorageName: aString 	(aString includes: Character space) ifTrue: [^false].	[self checker checkName: aString fixErrors: false.] on: Error do: [:ex | ^false]. 	self multilingalNameAllowed ifFalse: [ ^ (aString isKindOf: WideString) not ].	^true.! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 6/12/2009 12:47'!isValidStructureName: aString 	^self isValidStorageName: aString! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 9/21/2008 22:38'!limitedColorSpace	^self supportedColorSymbols isEmpty not.! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 9/21/2008 23:06'!limitedColors	^self supportedColorSymbols collect: [ :colorSymbol | Color perform: colorSymbol].! !!GdsCompatibility methodsFor: 'testing' stamp: 'kf 10/23/2008 11:41'!multilingalNameAllowed	^ true! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 11/10/2008 13:17'!itemNumberMax	^9! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 11/10/2008 13:17'!itemNumberMin	^0! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 11/10/2008 13:17'!itemNumberRange	^Interval from: self itemNumberMin to: self itemNumberMax. ! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 10/23/2008 11:10'!layerNumberMax	^255.! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 10/23/2008 11:10'!layerNumberMin	^0.! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 10/23/2008 11:13'!layerNumberRange	^Interval from: self layerNumberMin to: self layerNumberMax. ! !!GdsCompatibility methodsFor: 'acessing' stamp: 'kf 6/12/2009 10:59'!libNameMax	^-1! !!GdsCompatibility methodsFor: 'category name' stamp: 'kf 10/23/2008 09:58'!supportedColorSymbols	^#() copy.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!GdsCompatibility class	instanceVariableNames: ''!!GdsCompatibility class methodsFor: 'as yet unclassified' stamp: 'kf 10/23/2008 10:53'!activeClass	GdsCompatibility allSubclasses do: [:class |		class isActive ifTrue: [^ class]].	^ GdsCompatibility ! !!GdsCompatibility class methodsFor: 'as yet unclassified' stamp: 'kf 10/23/2008 23:46'!checker	Checker ifNil: [Checker := DosFileDirectory new.].	^Checker.! !!GdsCompatibility class methodsFor: 'as yet unclassified' stamp: 'kf 10/23/2008 10:56'!setActiveClass	CompatibilityClass := self activeClass.! !!GdsCompatibility class methodsFor: 'actions' stamp: 'kf 10/23/2008 11:02'!create	CompatibilityClass ifNil: [self setActiveClass].	^CompatibilityClass new.! !!GdsCompatibility class methodsFor: 'defaults' stamp: 'kf 10/23/2008 11:03'!default	DefaultCompatibility ifNil: [DefaultCompatibility := self create.].	^DefaultCompatibility.! !!GdsCompatibility class methodsFor: 'class initialization' stamp: 'kf 5/6/2009 21:36'!initialize	"self initialize"	Smalltalk addToStartUpList: self.	! !!GdsCompatibility class methodsFor: 'testing' stamp: 'kf 10/23/2008 10:52'!isActive	^false! !!GdsCompatibility class methodsFor: 'system startup' stamp: 'kf 10/23/2008 11:06'!startUp	self setActiveClass.	! !Object subclass: #GdsFeel	instanceVariableNames: ''	classVariableNames: 'TypedMap'	poolDictionaries: ''	category: 'GdsFeel-Model-Spec'!!GdsFeel commentStamp: 'kf 11/8/2008 00:10' prior: 0!A GdsFeel is Project symbolic name.- not a real GUI class. (real class GdsStationUI).- project property holder like as NextStep's defaults (write|read) NSGlobalDomain.Instance Variables!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!GdsFeel class	instanceVariableNames: ''!!GdsFeel class methodsFor: 'private' stamp: 'kf 5/4/2009 22:21'!join: anArray using: joint	"TODO: using KFStringUtils #join:using:"	| path |	path := String streamContents: [:s |		anArray do: [:each | 			s nextPutAll: each.			s nextPutAll: joint]].	^path allButLast:  joint size.! !!GdsFeel class methodsFor: 'private' stamp: 'kf 11/10/2008 12:00'!pathFromComponents: anArray	^self join: anArray using: FileDirectory slash! !!GdsFeel class methodsFor: 'private' stamp: 'kf 10/20/2008 14:07'!pathToBetaNameItems	^self pathToSelfNameItems, {'Beta'}.! !!GdsFeel class methodsFor: 'private' stamp: 'kf 10/20/2008 11:17'!pathToSelfNameItems	^{ FileDirectory default pathName . 'GdsFeel' }! !!GdsFeel class methodsFor: 'debug-flags' stamp: 'kf 11/2/2009 11:40'!debugConsoleOut	^self typedMap booleanFor: #debugConsoleOut.! !!GdsFeel class methodsFor: 'debug-flags' stamp: 'kf 11/2/2009 11:40'!debugConsoleOut: aBoolean	self typedMap booleanFor: #debugConsoleOut value: aBoolean.	! !!GdsFeel class methodsFor: 'debug-flags' stamp: 'kf 11/14/2009 15:45'!fittingRatio	^self typedMap numberFor: #fittingRatio default:  GdsViewport defaultFittingRatio.! !!GdsFeel class methodsFor: 'debug-flags' stamp: 'kf 11/14/2009 15:51'!fittingRatio: aFloat	self assert: [aFloat <= 1.0 and: [aFloat >= 0.5]] description: 'fittingRatio specify between 0.5 and 1.0'.	^self typedMap numberFor: #fittingRatio value:  aFloat.! !!GdsFeel class methodsFor: 'accessing' stamp: 'kf 6/12/2009 10:21'!fileDirectory	^FileDirectory on: self pathToSelf.! !!GdsFeel class methodsFor: 'accessing' stamp: 'kf 11/7/2008 15:37'!pathToBeta	^self pathFromComponents: self pathToBetaNameItems.! !!GdsFeel class methodsFor: 'accessing' stamp: 'kf 11/7/2008 15:37'!pathToSelf	^self pathFromComponents: self pathToSelfNameItems.! !!GdsFeel class methodsFor: 'accessing' stamp: 'kf 11/2/2009 13:20'!typedMap	TypedMap ifNil: [ TypedMap := TypedConfigulation new ].	^ TypedMap! !!GdsFeel class methodsFor: 'debug' stamp: 'kf 10/27/2008 21:46'!ifDebug: aBlock	self debugConsoleOut ifFalse: [^self].	aBlock value.		! !!GdsFeel class methodsFor: 'debug' stamp: 'kf 10/27/2008 21:37'!ifDebugOn: aStreamBlock	self ifDebug: [		Transcript cr; show: 			(String streamContents: [ :stream |				stream nextPutAll: '***DEBUG***'.				stream nextPutAll: ' '.				aStreamBlock value: stream])].	! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 10/8/2009 15:26'!openReadMe	"self openReadMe."	"| window |	window := SystemWindow allSubInstances 						detect: [:w | w label sameAs: self readMeTitle] ifNone: [nil].	window ifNotNil: [window owner ifNotNil: [^self]]."	(StringHolder new contents: self readMeContents)		openLabel: self readMeTitle.! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 11/11/2009 16:44'!readMeContents	^self readMeV003! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 11/2/2009 14:02'!readMeTitle	^'README - ', (((self category asString splitOn: '-') allButLast) joinUsing: '-')! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 10/8/2009 10:27'!readMeV000	^'kf 10/8/2009 10:25- fix: can''t enabled button [OPENLIB]. after [INITLIB] '! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 10/28/2009 11:51'!readMeV001	^'kf 10/28/2009 11:49- add datatype, pathtype- change layer -> layerNumber.- fix: GeometryUtils>>#removeDuplicatePoints:on:'! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 11/2/2009 14:06'!readMeV002	^'V002______move GUI configulation methods to GdsFeelMorphic(GdsFeel-Morphic mcz Package).- #goodiesEnabled- #goodiesEnabled:- #debugStretchFeedback - #debugStretchFeedback: - #debugFindElement - #debugFindElement: - #debugPathBoundary: - #clickSoundEnabled - #clickSoundEnabled: - #debugPathBoundary '! !!GdsFeel class methodsFor: 'documentation' stamp: 'kf 11/14/2009 15:10'!readMeV003	^'V003______- GdsViewport screen allocate margin attribute.  defaultFittingRatio => 0.98.- fix: Can''t effect floating number grid.'! !!GdsFeel class methodsFor: 'maintenance' stamp: 'kf 11/2/2009 13:20'!migrateConfigulationValues	"self migrateConfigulationValues"	| lowerCapital |	TypedMap ifNil: [ TypedMap := TypedConfigulation new ].	lowerCapital := 	[ :symbol | 	| varName |	varName := symbol asString.	varName first asString asLowercase , varName allButFirst ].	(self classVarNames reject: [ :each | each = #TypedMap ]) do: 		[ :each | 		(self classPool at: each) ifNotNilDo: 			[ :clazzVar | 			TypedMap 				instVarNamed: (lowerCapital value: each)				put: clazzVar copy ] ]! !!GdsFeel class methodsFor: 'maintenance' stamp: 'kf 11/13/2009 16:55'!rebuild	"GdsFeel rebuild"	(Smalltalk allClasses select: [:clazz |		#('KF' 'Gds' 'Gpl') anySatisfy: [:each | clazz name beginsWith: each]])		do: [:clazz |			clazz compileAll]! !!GdsFeel class methodsFor: 'class initialization' stamp: 'kf 11/11/2009 16:47'!initialize	"self initialize"	"self openReadMe."	! !!GdsFeel class methodsFor: 'objects from disk' stamp: 'kf 11/7/2009 23:02'!fileOutXmlTopElement: aXMLElement fileDirectory: aFileDirectory localName: aLocalName 	| doc stream writer |	aFileDirectory assureExistence.	stream := nil.		[ doc := XMLDocument new version: 1.0 asString.	stream := FileStream forceNewFileNamed: (aFileDirectory fullNameFor: aLocalName).	doc addElement: aXMLElement.	writer := XMLWriter on: stream.	writer canonical: false.	doc printXMLOn: writer ] ensure: [ stream ifNotNil: [ stream close ] ]! !!GdsFeel class methodsFor: 'objects from disk' stamp: 'kf 11/8/2009 21:07'!xmlDocumentFromPath: aString documentBlock: aBlock	| stream doc |	stream := nil.	[stream := FileStream readOnlyFileNamed: aString .	doc := XMLDOMParser parseDocumentFrom: stream.	aBlock value: doc.]		ensure: [stream ifNotNil: [stream close]].! !GdsCompatibility subclass: #GdsStrictCompatibility	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'GdsFeel-Model-Spec'!!GdsStrictCompatibility methodsFor: 'testing' stamp: 'kf 10/23/2008 10:15'!elementColorAllowed	^false! !!GdsStrictCompatibility methodsFor: 'testing' stamp: 'kf 10/23/2008 11:41'!multilingalNameAllowed	^ false! !!GdsStrictCompatibility methodsFor: 'acessing' stamp: 'kf 10/23/2008 11:15'!layerNumberMax	^63! !!GdsStrictCompatibility methodsFor: 'acessing' stamp: 'kf 6/12/2009 10:58'!libNameMax	^10! !!GdsStrictCompatibility methodsFor: 'category name' stamp: 'kf 9/21/2008 23:03'!supportedColorSymbols	^#(blue cyan green magenta red white yellow).! !GdsStrictCompatibility subclass: #GdsBetaCompatibility	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'GdsFeel-Model-Spec'!!GdsBetaCompatibility methodsFor: 'as yet unclassified' stamp: 'kf 10/23/2008 11:50'!coerceStructureName: aString	^(super coerceStructureName: aString) asUppercase.! !!GdsBetaCompatibility methodsFor: 'as yet unclassified' stamp: 'kf 10/22/2009 21:38'!libNameMax	^32! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!GdsBetaCompatibility class	instanceVariableNames: ''!!GdsBetaCompatibility class methodsFor: 'as yet unclassified' stamp: 'kf 10/23/2008 10:51'!isActive	^true.! !GdsCompatibility initialize!GdsFeel initialize!